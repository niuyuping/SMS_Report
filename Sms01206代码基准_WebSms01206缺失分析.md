# Sms01206 代码基准 — WebSms01206 缺失分析

**说明**：仅基于 **Sms01206 与 WebSms01206 的代码** 分析，不依赖任何已有文档。以 Sms01206（OrderEntryNo + OrderEntryNo_i + 各 Dialog）为基准，对比 SmsWeb 的 WebSms01206 功能与画面的缺失。

---

## 一、Sms01206 代码中的功能与画面（基准）

### 1. 主画面（OrderEntryNo.java）

- **单一主画面**：一个 Applet 主窗体，包含以下要素。

#### 1.1 头部操作

| 元素 | 说明 | 对应逻辑 |
|------|------|----------|
| エントリーNo | entryNo_ | 输入/显示 |
| 採番 | getEntryNo() | 已实现 |
| 検索 | searchButton_ | getOrderSub → getOrder，QR 読取等 |
| 集 | collectButton_ | collectButtonAction：将 updateHash_ 反映到 beforeHash_（画面状态“收集”） |
| 機種検索 | productButton_ | 打开 ProductDialog |
| 製品在庫計画 | seihinButton_ | kidouSms01228：起動 stemapki（製品在庫計画） |
| 追加 | insertButton_ | 确认后 orderInsert |
| 更新 | updateButton_ | 确认后 orderUpdate |
| 削除 | deleteButton_ | 确认后 orderDelete |
| クリア | clearButton_ | 表单清空 |
| 終了 | closeButton_ | 关闭 |
| 出荷依頼表 | issueButton_ | kidouScp05101 → getForwadingListHtml |

#### 1.2 枝番（SubNo）

- **subNo1_ ～ subNo10_**：切换当前枝番（0～9），setSubNoData("0")～("9")，对应 getOrder(key, key1)。

#### 1.3 主表单字段（与 OrderEntryNo_i / 画面 Bean 一致）

- 担当(chargeChoice_)、顧客注文No(orderNo_)、コメント(note_)、納品書(voucherChoice_)、納品(deliveryChoice_)、カートン種類(cartonChoice_)、使用ユーザー(userChoice_)
- 得意先(customerChoice_)、配送先関連(address_, section_, tel_)、配送先選択(consignButton_ → ConsignDialog)
- 納入先(supplyChoice_)、メーカー(makerChoice_)、caseMark1_～7、npmEntryNo_
- 機種(productChoice_)、ランク(rankButton_ → RankDecisionDialog)、販価(price_)、通貨(currencyChoice_)、顧客機種(kokyakuProduct_)、用途(useChoice_)、扱い(handleChoice_)、ルート(routeChoice_)
- 添付(attachmentChoice_)、検査結果部添付(reportCopy_)、仕様書部添付(specificationCopy_)
- **OUT-IN 関連**：oiPanel_、leadTimeChoice_、nisuu_、consign_、oiPanel2_、coopeButton_、psLabel_、psChoice_、oiBLabel_ 等

#### 1.4 明細テーブル（table_）

- 枝番・注文数・出荷済・出荷残・分割・納期・出荷希望日・回答日・回答区分・乙仲出荷日・売上日・プラント・保管場所・税・インボイスNo・回収月・特・コメント 等。行操作から「分割」「配分」等で Dialog を開く。

---

### 2. 弹窗（Dialog）— 代码中实际存在的画面

| Dialog | 类名 | 用途 |
|--------|------|------|
| ProductDialog | ProductDialog.java | 機種検索（getProductDialogMaster） |
| ForwardRequestDialog | ForwardRequestDialog.java | 出荷依頼票出力用（getForwardDialogMaster） |
| RankDecisionDialog | RankDecisionDialog.java | ランク決定 |
| DistributeOrderDialog | DistributeOrderDialog.java | **分割**（分割値入力） |
| DeployOrderDialog | DeployOrderDialog.java | **継続プラント**（ランク・R3 等、displayDeployOrderDialog） |
| DeployDistributeDialog | DeployDistributeDialog.java | **配分**（継続配分） |
| TaxDialog | TaxDialog.java | **税区分**選択（リスト list1_） |
| ConsignDialog | ConsignDialog.java | 配送先選択・自由入力 |
| OutinDialog | OutinDialog.java | OUT-IN 連携編集 |
| FactoryNumberDialog | FactoryNumberDialog.java | **出荷実績入力（無償出荷）**（setFactoryResults） |
| ConfirmDialog | ConfirmDialog.java | 追加/更新/削除等の確認メッセージ |

---

### 3. RMI 接口（OrderEntryNo_i）中的方法

以下均为 Sms01206 侧已存在的业务入口（代码基准）：

- getLabelString, getSales, getPattern, getPrice, insert, update  
- getProductDialogMaster, getForwardDialogMaster, getRankDialogMaster  
- getEntryNo, getOrderSub, getOrder  
- getVari, getConsigns, getConsign, getCharges, getChargeCustomers, getCustomerProducts, getCustomers, getProducts, getUses  
- getNpmEntry, orderInsert, orderUpdate, orderDelete  
- getSupplys, judgmentERP, moveR3, isHoliday, getUnitPrice, isUnitPriceMaster  
- getMakerMaster, getPriceCodeMaster, updatePriceCode, getExcelData  
- getNpmLine, getKoOrder, isDeployPriceMaster, getDeployEntry  
- getDistributeDeploy, distributeDeploy, updateSmsStatus, updateSmsStatusClear  
- updateKoOrder, getOyaOrder, judgmentStopProduct, getPSSPeriodProduct, getQSeihinHash  
- judgementCustomerConfidence, reloadCustomerConfidence, getProductPlant, getNpmProductDivision  
- getActiveDate, getTransportList, getOutInData, getMultiRate, updateOutinData  
- getDefaultConsigns, getForwadingListHtml, setFactoryResults, getMaxSalesUpdate  
- judgementNNSN, isDuplicationOrder, isDuplicationOrder2, getCustomerForwardReadTime  
- getProductFromCustomerProduct, getInvoiceNoCount, getTurnoverDate  

---

## 二、WebSms01206 已实现部分（代码确认）

- **画面**：list.jsp（一覧）、createForm.jsp（新規/編集）、detail.jsp（詳細）、createConfirm.jsp（登録確認）
- **API**：Controller 与 Service 已对上述 OrderEntryNo_i 的绝大多数方法做了透传或封装（getOrderSub, getOrder, orderInsert/Update/Delete, getVari, getCharges, getCustomers, getProducts, getPrice, getUnitPrice, getConsigns, getConsign, getSupplys, getNpmEntry, getUses, getMakerMaster, getPriceCodeMaster, getDefaultConsigns, judgmentERP, isHoliday, isUnitPriceMaster, getTransportList, isDuplicationOrder, getTurnoverDate, getExcelData, updatePriceCode, getConporison, getMultiRate, getActiveDate, getChargeCustomers, getCustomerForwardReadTime, moveR3, getNpmLine, getKoOrder, isDeployPriceMaster, getDeployEntry, getDistributeDeploy, distributeDeploy, updateSmsStatus, updateSmsStatusClear, updateKoOrder, getOyaOrder, judgmentStopProduct, getPSSPeriodProduct, getQSeihinHash, judgementCustomerConfidence, reloadCustomerConfidence, getProductPlant, getNpmProductDivision, getOutInData, updateOutinData, getForwadingListHtml, setFactoryResults, getMaxSalesUpdate, judgementNNSN, isDuplicationOrder2, getProductFromCustomerProduct, getInvoiceNoCount, getLabelString, getSales, getPattern, getProductDialogMaster, getForwardDialogMaster, getRankDialogMaster 等）
- **createForm 上的控件**：エントリーNo・採番・検索・枝番切替・担当～使用ユーザー・得意先・配送先・納入先・メーカー・caseMark・NPM・機種・ランク・販価・通貨・顧客機種・用途・扱い・ルート・添付・検査結果/仕様書部数・明細テーブル（注文数・出荷済・出荷残・分割・納期・出荷希望日・回答日・回答区分・乙仲・売上日・プラント・保管場所・税・インボイスNo・回収月・特・コメント・操作）
- **已包含的 Dialog（JSP）**：forwardDialog、consignDialog、rankDialog、productDialog、outinDialog、distributeDialog、deployDistributeDialog、confirmModal、alertModal、waitDialog
- **製品在庫計画**：createForm 上有「製品在庫計画」按钮，通过 seihinPlanBaseUrl 跳转（与 Sms01206 的 kidouSms01228 相当）
- **出荷依頼表**：createForm 上「出荷計画」调用 getForwadingListHtml（与 issueButton_ 相当）

---

## 三、WebSms01206 相对 Sms01206 的缺失（仅代码对比）

### 1. 画面/操作缺失

| 项目 | Sms01206 代码 | WebSms01206 状态 |
|------|----------------|------------------|
| **「集」按钮** | collectButton_ + collectButtonAction（updateHash_ → beforeHash_） | **未实现**。无“集”按钮及对应状态收集逻辑。 |
| **TaxDialog** | TaxDialog（税区分リスト選択） | **未实现**。明细行仅有税区分下拉（taxFlg），无单独税区分选择弹窗。 |
| **DeployOrderDialog（継続プラント）** | DeployOrderDialog（dialog2_），displayDeployOrderDialog / setValue1 / setValue2、isR3Button 等 | **未实现**。Web 仅有 deployDistributeDialog（配分）与 rankDialog（ランク決定），无独立的「継続プラント」专用 Dialog。 |
| **FactoryNumberDialog** | 出荷実績入力（無償出荷）专用画面，setFactoryResults 用 | **API 已有** setFactoryResults；**画面**上无单独「無償試作出荷実績登録」弹窗入口（仅在 forwardDialog 等处有出荷済数显示）。 |
| **OUT-IN 主画面区域** | oiPanel_、leadTimeChoice_、nisuu_、coopeButton_、psChoice_ 等主画面控件 | **未完全还原**。outinDialog 存在，但主画面没有与 Sms01206 同等的「リードタイム・日数・協力・PS」等集中区域。 |
| **QR コード読取** | searchButton 内 readQRCode() | **未实现**。Web 検索无 QR 读取。 |

### 2. 行为/逻辑差异（可能影响等价性）

- **検索后状态**：Sms01206 検索后有 collect/insert/update/delete/close 等按钮的 enable 制御、entryNo 背景色等；Web 的 searchOrder 与按钮状态是否完全一致需按画面规格再确认。
- **出荷依頼表**：Sms01206 的 issueButton_ 仅在特定条件下 setVisible(true)（例：entry 存在且为 B 系等）；Web 为「isBEntry 时显示出荷計画」，条件是否与旧版完全一致需对照业务。
- **確認 Dialog**：Sms01206 使用 ConfirmDialog（getLabelString("ConfirmDialog", keys)）；Web 使用 confirmModal/alertModal，文案是否全部来自 getLabelString 需确认。

### 3. API 层面

- OrderEntryNo_i 中定义的方法在 WebSms01206 的 Controller/Service 中**基本均有对应**（透传或封装）。
- **缺失点**：无新增 API 缺失；缺失主要在**画面与操作**（上述「集」、TaxDialog、DeployOrderDialog、FactoryNumberDialog 画面、OUT-IN 主画面区、QR）。

### 4. 一覧/詳細/确认画面

- **list**：Web 有 list.jsp + getOrderSub，与 Sms01206 一覧相当。
- **detail**：Web 有 detail.jsp，用 getOrder 的 model 表示；字段与 Sms01206 主表单+明细对应。
- **createConfirm**：Web 有 createConfirm.jsp，与 Sms01206 的确认后登録流程相当。

---

## 四、缺失汇总（仅代码基准）

1. **「集」按钮及 collect 逻辑** — 未在 Web 实现。  
2. **TaxDialog** — 税区分用单独列表弹窗未实现。  
3. **DeployOrderDialog** — 継続プラント用独立 Dialog 未实现（Web 仅有配分・ランク）。  
4. **FactoryNumberDialog 画面** — setFactoryResults 用「無償試作出荷実績登録」专用弹窗未实现。  
5. **OUT-IN 主画面区域** — 主画面上的 leadTime/日数/協力/PS 等控件未完全还原。  
6. **QR コード読取** — 検索时的 QR 读取未实现。

以上均以 **Sms01206 与 WebSms01206 的源代码** 为唯一依据整理，不依赖项目内其他文档。
