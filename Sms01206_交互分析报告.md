# Sms01206 按画面详细交互分析报告

本报告**仅依据 Sms01206 源码**（OrderEntryNo、OrderEntryNo_s、OrderEntryNo_i 及各 Dialog），不参考 SmsWeb。**按画面逐个**详细描述：画面上的所有交互行为、每个组件的行为、所有接口调用逻辑、每个组件的行为约束、画面与其它画面的调用关系、画面相关的数据表。

---

# 画面一：主画面（订单录入・按エントリーNo）

**类名**: `OrderEntryNo`  
**包**: `SMS01206`  
**继承**: `CDJApplet`（Java Applet / HTA）  
**尺寸**: 980×680（逻辑坐标）  
**标题**: オーダーエントリー（ｴﾝﾄﾘｰNo.別）

---

## 1.1 画面上的所有交互行为

| 交互动作 | 触发方式 | 结果概要 |
|----------|----------|----------|
| 输入エントリーNo 后回车 | entryNo_ 的 Action | 执行检索：getCutEntryNo 规范化 → getOrderSub；有数据则显示头与表并刷新枝番按钮，无数据则 entryNo 背景红、部分按钮禁用 |
| 点击「採番」 | collectButton_ 点击 | 取得新 entryNo（getEntryNo），进入新规追加状态：头/表清空或继承当前更新内容，insert 有效、search/collect 无效，entryNo 只读 |
| 点击「検索」 | searchButton_ 点击 | 先 confirm("update")；可选 QR 读码；再 searchEntryNo() → getOrderSub，按结果刷新枝番与表 |
| 切换担当 | chargeChoice_ 的 Action/Item | getChargeCustomers → 刷新 customerChoice_ 列表 |
| 切换得意先 | customerChoice_ 的 Action/Item | getConsigns、getSupplys、getDefaultConsigns 等 → 刷新 address_/section_/tel_/supplyChoice_/deliveryChoice_ 等；与信判定 |
| 切换机种 | productChoice_ 的 Action/Item | 机种相关校验（ERP、廃機種、生販確定期間、用途、継続プラント贩价等）；刷新贩价等 |
| 点击「ランク」 | rankButton_ 点击 | 打开 RankDecisionDialog；选择后写回 rank_ 并 setUpdateHead |
| 点击「配送先」 | consignButton_ 点击 | 打开 ConsignDialog；选择后回填配送先头项目与 consign_ |
| 点击枝番按钮 subNo1～10 | 各 subNo 点击 | setSearchData(selectNo_, "sub")：切换当前枝番，刷新头与明细表 |
| 编辑表单元格 | table_ 的 编辑/焦点/键/鼠标 | 写入 beforeHash_/updateHash_/subHash_；日期列校验；回答区分列可弹出 ReplyDialog |
| 点击「追加」 | insertButton_ 点击 | insert("insertButton")：头表校验 → 确认 → orderInsert；成功后可选关闭画面 |
| 点击「更新」 | updateButton_ 点击 | update(false)：校验 → orderUpdate |
| 点击「削除」 | deleteButton_ 点击 | 确认后 orderDelete 或 R3 参照画面时 updateReferScreenR3Data |
| 点击「クリア」 | clearButton_ 点击 | 清空表与头编辑区域 |
| 点击「終了」 | closeButton_ 点击 | entryNo 为空则直接关闭；否则先执行 insert/update 再 closeScreen |
| 点击「出荷計画」 | issueButton_ 点击 | 仅 entryNo 头文字 "B" 时打开 scp05101（URL/HTA） |
| 点击「机种检索」等 | productButton_ 点击 | 打开 ProductDialog；选择结果回填 product 相关 |

---

## 1.2 画面上每个组件的行为

### 1.2.1 エントリーNo 区域

| 组件 | 类型 | 标签/用途 | 行为 |
|------|------|-----------|------|
| jFMultiLineLabel3 | 标签 | ｴﾝﾄﾘｰNo. | 固定文本，无交互 |
| entryNo_ | JFFieldString | エントリーNo | 输入后 Action 触发 searchEntryNo；採番后 setEditable(false)；getCutEntryNo 规范化 |
| collectButton_ | JFImageButton | 採番 | 点击 → collectButtonAction() → getEntryNo()，进入新规状态 |
| searchButton_ | JFImageButton | 検索 | 点击 → confirm → searchEntryNo() → getOrderSub |
| come1_, come2_, come3_ | JFMultiLineLabel | 信息/与信等 | 显示用；内容由逻辑设置 |
| label15_ | JFMultiLineLabel | 同梱/会社間状况 | 红色，显示同梱品・会社間关系说明 |

### 1.2.2 头区域（ヘッダー）

| 组件 | 类型 | 标签 | 行为 |
|------|------|------|------|
| chargeChoice_ | JFChoice(可编辑) | 担当 | Action/Item → getChargeCustomers → 刷新 customerChoice_；必选 |
| customerChoice_ | JFChoice(可编辑) | 得意先 | Action/Item → getConsigns/getSupplys/getDefaultConsigns → 刷新 address_/section_/tel_/supplyChoice_/deliveryChoice_ 等；必选 |
| orderNo_ | JFFieldString | 顧客注文No. | Focus/校验；长度与禁止字符；OrderNo 重複/金型重複 check |
| note_ | JFFieldString | ｺﾒﾝﾄ | Focus 校验 |
| voucherChoice_ | JFChoice | 納品書 | Item 变更 |
| deliveryChoice_ | JFChoice | 納品 | Item 变更 |
| cartonChoice_ | JFChoice | ｶｰﾄﾝ種類 | Item 变更 |
| userChoice_ | JFChoice(可编辑) | 使用ﾕｰｻﾞｰ | Action/Item |
| address_ | JFFieldString(只读) | 住所建物 | 由 customer 带出 |
| section_ | JFFieldString(只读) | 会社部署 | 由 customer 带出 |
| tel_ | JFFieldString(只读) | 担当TEL | 由 customer 带出 |
| supplyChoice_ | JFChoice | 納入先ｺｰﾄﾞ | 担当/得意先变更后刷新；扱い 3/4 时必选且须有效代码 |
| makerChoice_ | JFChoice(可编辑) | 装置ﾒｰｶｰ | Action/Item；getMakerMaster |
| caseMark1_～7_ | JFFieldString | ｹｰｽﾏｰｸ1～7 | Focus；NNSN/特定法人时 caseMark5 可作输入者 |
| npmEntryNo_ | JFFieldString | 機展書No. | Action/Focus；機展書 DB 连动、入力チェック |
| productChoice_ | JFChoice(可编辑) | 機種 | Action/Item；getCustomerProducts/getProducts；ERP・廃機種・生販確定期間等校验 |
| price_ | JFFieldString(右对齐) | 販価 | Action/Focus；getPrice/getUnitPrice；法人・ランク下可限制为标准贩价 |
| currencyChoice_ | JFChoice | 通貨 | Item；会社間 rank=1 时限制 Y/D/E 等 |
| kokyakuProduct_ | JFFieldString | 得意先機種 | Focus |
| useChoice_ | JFChoice(可编辑) | 用途 | Action/Item；用途チェック |
| handleChoice_ | JFChoice | 扱い | Item；影响配送先/纳入先必须校验 |
| routeChoice_ | JFChoice | ルート | Item |
| rankButton_ | JFImageButton | ランク | 打开 RankDecisionDialog；选择后写回 rank_ |
| rank_ | JFMultiLineLabel | ランク表示 | 只读显示 |
| attachmentChoice_ | JFChoice | 部添付 | Item |
| reportCopy_ | JFFieldString(数字) | 部添付(報告書) | Focus |
| specificationCopy_ | JFFieldString(数字) | 部添付(仕様書) | Focus |
| consignButton_ | JFImageButton | 配送先 | 打开 ConsignDialog；选择后回填 consign 相关 |
| consign_ | JFFieldString | 配送先(OUT-IN等) | 扱い 2/4/B/D 时配送先コード校验 |

### 1.2.3 OUT-IN 区域（oiPanel_ / oiPanel2_）

| 组件 | 行为 |
|------|------|
| oiLabel_, oiBLabel_ | 说明标签 |
| leadTimeChoice_ | リードタイム选择 |
| nisuu_ | 日数输入 |
| coopeButton_ | 协同 Toggle |
| psLabel_, psChoice_ | プラント・保管场所 |
| outinCustomerLabel_ | OUT-IN 客户表示 |
| factoryLabel_ | 试作出荷 最终更新日时等 |

### 1.2.4 明细表 table_

- **类型**: JFTableView；行数由 TBL_MAX_DETAIL=20 决定。
- **列**: NO_DETAIL(0), ORDER_DETAIL(1), FACTORY_DETAIL(2), REMAIN_DETAIL(3), DELIVERY_DETAIL(5), FORWARD_DETAIL(6), REPLY_DETAIL(7), REPLY_CODE_DETAIL(8), FORWARD2_DETAIL(9), ON_BOARD_DETAIL(10), PLANT_DETAIL(11), STOCK_DETAIL(12), TAX_DETAIL(13), INVOICE_NO_DETAIL(14), COLLECT_MONTH_DETAIL(15), COMMENT_DETAIL(16), CARRIER_OUT/IN_DETAIL(17,18), INSPECT_DETAIL(19) 等。
- **事件**: MouseListener, JFTableViewActionListener, TextListener, ItemListener, FocusListener, KeyListener。
- **行为**: 编辑结果写入 beforeHash_/updateHash_/subHash_；纳期・出荷希望日・回答日等 dateCheck8；回答区分列可弹出 ReplyDialog；根据 status 等控制可编辑性；出荷済み(mente2)时仅部分列可更新。

### 1.2.5 枝番按钮与操作按钮

| 组件 | 行为 |
|------|------|
| subNo1_～subNo10_ | 检索后按 orderHash_ 显示机种；点击 setSearchData(selectNo_, "sub") 切换枝番并刷新 |
| productButton_ | 打开 ProductDialog；回填 product 相关 |
| seihinButton_ | 制品区分等处理 |
| insertButton_ | insert("insertButton") → orderInsert |
| updateButton_ | update(false) → orderUpdate |
| deleteButton_ | 确认 → orderDelete 或 updateReferScreenR3Data |
| clearButton_ | 清空表与头 |
| closeButton_ | 未保存则先 insert/update 再 closeScreen |
| issueButton_ | entryNo 头文字 "B" 时起動 scp05101 |
| pkChoice_ | Item；getPriceCodeMaster/updatePriceCode |

---

## 1.3 画面所有的接口调用逻辑

| 调用方法 | 触发时机 | 主要参数 | 返回值/用途 |
|----------|----------|----------|-------------|
| getLabelString | 初期化 | LANG, TYPE 等 | 画面标签 labels_ |
| getCharges | 初期化 | KEY, CORPORATE, TYPE, LANG | chargeChoice_ 列表 |
| getChargeCustomers | 担当变更 | KEY(charge) 等 | customerChoice_ 列表 |
| getCustomers | 得意先列表 | KEY, CORPORATE, TYPE, LANG | customerChoice_ |
| getConsigns | 得意先变更 | KEY(customer) 等 | 配送先列表 |
| getConsign | 配送先单件 | KEY 等 | 配送先明细 |
| getDefaultConsigns | 得意先变更 | 同上 | 扱い/配送先/纳入先初期值 |
| getSupplys | 纳入先 | CORPORATE, KEY 等 | supplyChoice_ |
| getProducts | 机种列表 | KEY 等 | productChoice_ |
| getCustomerProducts | 得意先变更 | KEY(customer) 等 | productChoice_ |
| getUses | 用途 | KEY 等 | useChoice_ |
| getVari | 初期化 | - | 回答区分 replys_ |
| getNpmEntry | 機展書No | KEY 等 | 機展書 DB |
| getEntryNo | 採番 | - | 新 entryNo |
| getOrderSub | 检索 | KEY=entryNo, KEY1=paraCustomer_, LANG, CORPORATE, TYPE | orderHash_, 枝番列表 |
| getOrder | 按枝番取得/他枝番追加 | KEY=entryNo, KEY1=subNo 等 | beforeHash_ |
| orderInsert | 追加 | KEY=beforeHash_, KEY1=paraDPCorporate_, OUTIN, CORPORATE, TYPE, KEY6 | 插入件数 ans, 失败时 ans1 |
| orderUpdate | 更新 | KEY=updateHash_, KEY1=subHash_, OUTIN, key2=mente2 等 | 更新结果 |
| orderDelete | 削除 | KEY=entryNo, CORPORATE, TYPE | 删除结果 |
| getPrice / getUnitPrice | 贩价取得 | KEY 等 | 单价 |
| getPriceCodeMaster / updatePriceCode | 贩价决定区分 | prm | pkChoice_ / 更新 |
| getMakerMaster | 装置メーカー | prm | makerChoice_ |
| getProductDialogMaster | ProductDialog 用 | prm | 机种・得意先检索 |
| getForwardDialogMaster | ForwardRequestDialog 用 | prm | 出荷依頼票 |
| getRankDialogMaster | RankDecisionDialog 用 | prm | ランク |
| judgmentERP / judgmentStopProduct / getPSSPeriodProduct | 机种校验 | KEY 等 | ERP/廃機種/生販確定期間 |
| isUnitPriceMaster / isDeployPriceMaster | 贩价存在 | prm | 可否设定 rank 等 |
| getContinuePlant / getDeployEntry / getDistributeDeploy / distributeDeploy | 継続/会社間 | prm | 継続プラント・派生 |
| updateSmsStatus / updateSmsStatusClear | R3/同梱品 | prm | 状态 Q 等 |
| updateKoOrder | 同梱品亲更新 | prm | 子エントリ连动 |
| moveR3 / getR3moveHantei 等 | R3 移行 | prm | 移行/判定 |
| getOutInData / updateOutinData | OUT-IN | prm | OUT-IN 连携 |
| getMaxSalesUpdate / setFactoryResults | 试作出荷 | KEY=entryNo 等 | 最终更新日时/登録 |
| executeQuery(sms01206.getOrderNoData/getOrderNoData2) | OrderNo/金型重複 | ID+参数 | 是否重复 |
| insertOrder (SMSServerIfc) | orderInsert 内部 | hash | 插入件数 |

---

## 1.4 画面中每个组件的行为约束

- **entryNo_**: getCutEntryNo 规范化；唯一性由 getOrderSub/orderInsert 侧保证；法人 N/3 时採番前缀 "M"。
- **chargeChoice_ / customerChoice_**: 必选；得意先变更后配送先/纳入先/住所等联动；与信 6/8/9 时可能限制或警告。
- **orderNo_**: 长度与禁止字符（如 '）；OrderNo 重複、金型重複(NNSN)、インボイスNo 重複许容数。
- **productChoice_**: ERP/廃機種/生販確定期間/継続プラント贩价存在；用途一致；法人・ランク下标准贩价限制。
- **price_ / currencyChoice_**: 会社間 rank=1 时通貨限定 Y/D/E 等；贩价存在 isUnitPriceMaster。
- **配送先(consign_)**: 扱い 2/4/B/D 时必选且为选择数字（checkConsignCode）。
- **supplyChoice_**: 扱い 3/4 时必选且有效（checkSupplyCode）。
- **日期**: 纳期・乙仲出荷日・回答日等日历校验；OUT-IN 过去日 checkPastDate。
- **table_**: d_order_number=0 的行不插入；出荷済み(mente2)时仅 FORWARD2_DETAIL, ON_BOARD_DETAIL, INVOICE_NO_DETAIL 可更新。

---

## 1.5 画面与其它画面的调用关系

- **被谁打开**: 作为 Applet/HTA 主画面由外部起動（参数 firstEntry_、kidou_、paraCustomer_、paraOutIn_ 等）。
- **打开谁**:  
  - **ProductDialog**: productButton_ → productDialog_.show()；主画面实现 ProductDialog_i，提供 getProductDialogMaster。  
  - **ForwardRequestDialog**: forwardDialog_.show()；主画面提供 getForwardDialogMaster。  
  - **RankDecisionDialog**: rankButton_ → rankDecisionDialog_.show()；主画面提供 getRankDialogMaster。  
  - **ConsignDialog**: consignButton_ → dialog5_.show()；主画面实现 ConsignDialog_i。  
  - **OutinDialog**: dialog6_；主画面实现 OutinDialog_i。  
  - **DistributeOrderDialog / DeployOrderDialog / DeployDistributeDialog**: dialog_/dialog2_/dialog3_；会社間・分割・派生用。  
  - **TaxDialog**: dialog4_。  
  - **FactoryNumberDialog**: factoryDialog_.show()；主画面实现 FactoryNumberDialog_i。  
  - **ReplyDialog**: 表回答区分列 → replyDialog_.show()；主画面 initReplyDialog、setValue(replys_)。  
  - **Dialog1 (waitDialog_)**: 处理中 show/dispose。  
  - **JOptionPane (displayConfirmDialog)**: 追加/更新/削除/错误/R3 移行等确认。  
  - **scp05101**: issueButton_（entryNo 头 "B"）→ URL/HTA。

---

## 1.6 画面相关的数据表

- **订单头逻辑字段**（headItems_）: d_charge_code, d_customer_code, d_npm_entry_no, d_product_code, d_use_code, d_handle_code, d_route_code, d_order_no, d_note, d_voucher_code, d_attachment_code, d_delivery_code1, d_survey_report_copy, d_specification_copy, d_consign_code, d_consign_address, d_consign_section, d_consign_tel, d_carton_code, d_case_mark1～7, d_entry_no, d_customer_name, d_consign_name, d_unit_price, d_currency_code, d_decision_rank, d_customer_product, d_product_name, d_user_code, d_user_name, d_supply_code, d_supply_name, d_price_code, d_maker_code, d_maker_name, d_charge_name_english, d_use_name_english, d_entry_sub_no → 订单头表（具体表名以 sms_common insertOrder 为准）。
- **订单明细逻辑字段**（detailItems_）: d_detail_no, d_order_number, d_factory_number, d_remain_number, d_delivery_date, d_forward_date, d_reply_date, d_reply_code, d_forward2_date, d_on_board_date, d_plant_code, d_stock_location, d_tax_flg, d_invoice_no, d_collect_month, d_comment_note, d_carrier_out/in_date, d_inspect_date 及 package/status/original/continue/deploy 等 → 订单明细表。
- **マスタ系**: 担当・得意先・配送先・纳入先・机种・用途・扱い・装置メーカー・贩价・贩价决定区分・通貨等 → SMSServerIfc.getMaster 或各 getXxx 对应表。
- **機展書 DB**: getNpmEntry/getNpmLine/getNpmProductDivision 对应外部 NPM。
- **executeQuery**: sms01206.getOrderNoData、sms01206.getOrderNoData2 → 订单/金型重複用 SQL。

---

# 画面二：机种・得意先对话框（ProductDialog）

**类名**: `ProductDialog`  
**包**: `SMS01206`  
**继承**: `CDJDialog`  
**尺寸**: 约 412×556，setBounds(80,170,412,556)  
**标题**: ProductDialog（setLabel 后为「機種・得意先ダイアログ」等）

---

## 2.1 画面上的所有交互行为

| 交互动作 | 触发方式 | 结果概要 |
|----------|----------|----------|
| 打开时初始化 | init → initUser | setLabel、setSales、setPattern：调用 getProductDialogMaster(TYPE=LABEL/SALES/PATTERN) 取得标签与下拉数据 |
| 选择「他社向販売」 | salesChoice_ Item | 仅 select(key)，无额外服务端调用 |
| 选择「生産ﾊﾟﾀｰﾝ」 | patternChoice_ Item | 仅 select(key) |
| 点击「確認」 | confirmButton_ Action | confirm_=true，dispose；主画面用 isConfirm() 与 getValue() 取回数据 |
| 点击「閉じる」 | closeButton_ Action | confirm_=false，dispose |

---

## 2.2 画面上每个组件的行为

| 组件 | 类型 | 标签/用途 | 行为 |
|------|------|-----------|------|
| jFMultiLineLabel1 | 标签 | 機種・得意先ダイアログ | setLabel 从 labels_ 设置 |
| jFMultiLineLabel2～14 | 标签 | 得意先/機種/顧客仕様書No./様/他社向販売/ﾌﾟﾛｼﾞｪｸﾄｷｰﾏﾝ/手配ｷｰﾏﾝ/生産能力/ヶ月/台/生産ﾊﾟﾀｰﾝ/ﾌﾟﾛｼﾞｪｸﾄ詳細/確認/閉じる | 固定或 setLabel |
| customer_, customerName_ | 标签 | 得意先コード/名 | setValue/setDetail 时由主画面传入 |
| product_, productName_ | 标签 | 機種コード/名 | 同上 |
| customerNo_ | JFFieldString | 顧客仕様書No. | 输入；getValue()[0] |
| salesChoice_ | JFChoice | 他社向販売 | setSales() 用 getProductDialogMaster(TYPE=SALES) 填充；Item 时 select；getValue()[1] 取 code |
| projectKeyman_ | JFFieldString | ﾌﾟﾛｼﾞｪｸﾄｷｰﾏﾝ | 输入；getValue()[2] |
| tehaiKeyman_ | JFFieldString | 手配ｷｰﾏﾝ | 输入；getValue()[3] |
| productMonth_ | JFFieldString(数字) | 生産能力 月 | 输入；getValue()[4] |
| productNumber_ | JFFieldString(数字) | 生産能力 台 | 输入；getValue()[5] |
| patternChoice_ | JFChoice | 生産ﾊﾟﾀｰﾝ | setPattern() 用 getProductDialogMaster(TYPE=PATTERN) 填充；getValue()[6] 取 code |
| productDetail_ | JFFieldString | ﾌﾟﾛｼﾞｪｸﾄ詳細 | 输入；getValue()[7] |
| confirmButton_ | JFImageButton | 確認 | Action → confirm_=true，dispose |
| closeButton_ | JFImageButton | 閉じる | Action → confirm_=false，dispose |

---

## 2.3 画面所有的接口调用逻辑

| 调用方法 | 触发时机 | 参数 | 返回值/用途 |
|----------|----------|------|-------------|
| parent_.getProductDialogMaster(prm) | setLabel | COMPONENT=ProductDialog, KEYS=keys_, TYPE=LABEL | labels_ → 各标签文本 |
| parent_.getProductDialogMaster(prm) | setSales | TYPE=SALES | sales_ → salesChoice_ 列表 |
| parent_.getProductDialogMaster(prm) | setPattern | TYPE=PATTERN | patterns_ → patternChoice_ 列表 |

（parent_ 为主画面 OrderEntryNo，其 getProductDialogMaster 内部调用 remoteObject_.getProductDialogMaster。）

---

## 2.4 画面中每个组件的行为约束

- customerNo_、projectKeyman_、tehaiKeyman_、productDetail_：无长度/格式强制，由主画面侧使用 getValue() 后校验。
- productMonth_、productNumber_：TYPE_DIGIT，数字输入。
- salesChoice_、patternChoice_：选项来自服务端，选择后仅本地 select。

---

## 2.5 画面与其它画面的调用关系

- **被谁打开**: 主画面 OrderEntryNo 的 productButton_ → productDialog_.show()；打开前主画面 setValue/setDetail 传入得意先・机种等初期值。
- **打开谁**: 无；仅确认/关闭后 dispose，主画面根据 isConfirm() 与 getValue() 回填 product 相关。

---

## 2.6 画面相关的数据表

- 本画面不直接访问 DB；数据来自主画面调用的 **getProductDialogMaster**（OrderEntryNo_s 侧对应 getSales/getPattern 等，对应他社向販売・生産パターン等マスタ）。

---

# 画面三：出荷依頼票对话框（ForwardRequestDialog）

**类名**: `ForwardRequestDialog`  
**包**: `SMS01206`  
**继承**: `CDJDialog`  
**尺寸**: 约 732×392  
**标题**: ForwardRequestDialog

---

## 3.1 画面上的所有交互行为

- 初期化时 setLabel（主画面 getForwardDialogMaster 取得标签）。
- **新規印刷 / 修正印刷 / 削除印刷**: insertButton_/updateButton_/deleteButton_（Toggle）切换模式。
- **リスト / メモ**: jFListView1、note_ 显示与编辑出荷依頼票列表与备注。
- **Excel**: excelButton_ 点击导出或打印。
- **p5Button1～4**: 与列表/筛选相关的辅助操作。
- **確認**: confirmButton_ → 确认后 dispose，主画面取结果。
- **閉じる**: closeButton_ → 不确认 dispose。

---

## 3.2 画面上每个组件的行为（概要）

| 组件 | 类型 | 行为 |
|------|------|------|
| insertButton_, updateButton_, deleteButton_ | JFToggleButton | 新規/修正/削除印刷模式切换；Item/Key 监听 |
| note_ | JFTextArea | 备注输入 |
| confirmButton_, closeButton_ | JFImageButton | 确认/关闭 |
| jFListView1 | JFListView | 出荷依頼票列表显示与选择 |
| excelButton_ | JFImageButton | Excel 导出等 |
| P5Label_, p5Button1～4 | 标签/按钮 | 辅助说明与操作 |
| midashi_, list1_, comeLabel_ | 标签/列表 | 标题与列表、消息 |

---

## 3.3 画面所有的接口调用逻辑

- 标签与列表数据通过主画面 **getForwardDialogMaster** 取得（主画面传入 LANG, CORPORATE）；具体 KEY/ANS 结构依 OrderEntryNo_s 的 getForwardDialogMaster 实现。

---

## 3.4 画面中每个组件的行为约束

- 依源码：列表与备注由服务端数据与编辑规则约束；模式切换影响后续确认提交内容。

---

## 3.5 画面与其它画面的调用关系

- **被谁打开**: 主画面 OrderEntryNo 中 forwardDialog_.show()（出荷依頼票相关流程）。
- **打开谁**: 无子画面。

---

## 3.6 画面相关的数据表

- 出荷依頼票相关数据由 **getForwardDialogMaster** 在服务端查询（具体表名以 OrderEntryNo_s 实现为准）。

---

# 画面四：ランク决定对话框（RankDecisionDialog）

**类名**: `RankDecisionDialog`（源码中由 OrderEntryNo 引用，类文件未在本次检索路径中找到）  
**用途**: ランク（decision_rank）选择

---

## 4.1～4.6 概要（据主画面调用反推）

- **交互**: 主画面 rankButton_ 打开；用户选择ランク后关闭；主画面 setUpdateHead(rank, RANK_HEAD)、rank_.setText。
- **接口**: 主画面提供 **getRankDialogMaster**，内部调用 remoteObject_.getRankDialogMaster。
- **与它画面关系**: 仅被主画面打开，选择结果回写主画面 rank_。
- **数据表**: ランク相关マスタ（由 getRankDialogMaster 实现决定）。

---

# 画面五：配送先对话框（ConsignDialog）

**类名**: `ConsignDialog`  
**包**: `SMS01206`  
**继承**: `CDJDialog`  
**尺寸**: 约 684×408，setBounds(40,220,684,408)  
**标题**: ConsignDialog

---

## 5.1 画面上的所有交互行为

| 交互动作 | 触发方式 | 结果概要 |
|----------|----------|----------|
| 打开时 setValue | 主画面调用 | 传入 datas(配送先列表)、consignData、startIndex、come3、data0；表与明细区刷新；无数据时显示说明 come3 |
| 表行点击 | table_ Mouse/Item/Key | 选中行数据填入 consign_/consignN_/address_/section_/tel_；clicks_ 记录；okButton 可用性 setButtonOK() |
| 「manual input」 | miButton_ Action | 切换手入力模式；miSw_ 控制 panel 布局 |
| 编辑 consignN_/tel_/section_/address_ | Action/Key | 手入力；长度校验 stringChecks_（128 字节等）；errors_ 记录；displayConfirmDialog 提示 |
| 点击 OK | okButton_ Action | confirm_=true，dispose；主画面用 getValue() 取配送先コード等 |
| 点击 CANCEL | cancelButton_ Action | confirm_=false，dispose |

---

## 5.2 画面上每个组件的行为

| 组件 | 类型 | 标签/用途 | 行为 |
|------|------|-----------|------|
| table_ | JFTableView | 配送先一覧 | 3 行×5 列（可调 ROW_MAX/ROW_MAX2）；点击行填入下方明细；不可编辑 |
| consignLabel_ | 标签 | コード | 固定 |
| consign_ | JFMultiLineLabel | 配送先コード | 选中行代码显示 |
| nameLabel_ | 标签 | 配送先名 | 固定 |
| consignN_ | JFFieldString | 配送先名 | 选中行或手入力；长度 128 校验 |
| come_ | JFMultiLineLabel | 说明/错误 | 无数据说明或错误信息 |
| miButton_ | JFImageButton | manual input | 切换手入力；布局变化 |
| adLabel_, scLabel_, telLabel_ | 标签 | 住所建物/会社部署/担当TEL | 固定 |
| tel_, section_, address_ | JFFieldString | 担当TEL/会社部署/住所建物 | 选中行或手入力；128 字节校验 |
| okButton_ | JFImageButton | OK | 确认；有选中或有效手入力时可用 |
| cancelButton_ | JFImageButton | CANCEL | 取消 |
| enLabel_, entry_ | 标签/标签 | エントリーＮＯ | 主画面传入的 entry 显示 |
| orderNoLabel_, orderNO_ | 标签/标签 | オーダーＮＯ | 主画面传入的 orderNo 显示 |
| noteLabel_, note_ | 标签/标签 | 特記事項 | 主画面传入的 note 显示 |

---

## 5.3 画面所有的接口调用逻辑

| 调用方法 | 触发时机 | 参数 | 返回值/用途 |
|----------|----------|------|-------------|
| parent_.getConsignDialogLabel(keys_) | setName（主画面 dialog5_.setName()） | keys_ | labels_ → 标签与 consignLabels_ |
| parent_.displayConfirmDialog(item) | 长度错误等 | 消息 key | 显示确认框 |

（主画面 OrderEntryNo 实现 ConsignDialog_i：getConsignDialogLabel 可从 labels 取得；displayConfirmDialog 为既有确认框。配送先列表数据由主画面 getConsigns 取得后通过 setValue(datas,...) 传入，本画面不直接调 RMI。）

---

## 5.4 画面中每个组件的行为约束

- **consignN_, address_, section_, tel_**: 长度 128 字节（stringChecks_）；超长时 errors_ 置位、come_ 显示消息、displayConfirmDialog；okButton 可用性 setButtonOK() 依赖 errors_。
- **table_**: 仅选择，不编辑；行数由 datas 长度决定，最大 ROW_MAX2=10 等。

---

## 5.5 画面与其它画面的调用关系

- **被谁打开**: 主画面 consignButton_ → dialog5_.show()；打开前主画面 getConsigns 取得列表，setValue(datas, consignData, startIndex, come3, data0) 传入。
- **打开谁**: 仅调用 parent_.displayConfirmDialog（与主画面共用确认框）。

---

## 5.6 画面相关的数据表

- 本画面不直接调 RMI；显示数据来自主画面的 **getConsigns**（得意先别配送先一覧），对应配送先マスタ/テーブル（具体表名以 OrderEntryNo_s getConsigns 为准）。consignLabels_ 与 keys_ 对应标签番号 5255～6776 等。

---

# 画面六：回答区分对话框（ReplyDialog）

**类名**: `ReplyDialog`  
**包**: `SMS01206`  
**继承**: `CDJDialog`  
**尺寸**: 约 212×256  
**标题**: ReplyDialog

---

## 6.1 画面上的所有交互行为

| 交互动作 | 触发方式 | 结果概要 |
|----------|----------|----------|
| 打开时 setValue | 主画面调用 | 传入 replys_(String[][])，list1_ 显示「code : name」行；无选择时 data_=new String[2], confirm_=false |
| 选择一行 | list1_ Item SELECTED | 解析 "code : name" → data_[0]=code, data_[1]=name；confirm_=true，dispose |
| 关闭未选 | 直接关闭 | confirm_=false；主画面 isConfirm() 为 false |

---

## 6.2 画面上每个组件的行为

| 组件 | 类型 | 行为 |
|------|------|------|
| list1_ | JFListView | 1 列，无表头；setValue 时 addRow + setString(i-1,0, data[i][0]+" : "+data[i][1])；Item SELECTED 时取选中行解析并 dispose |

---

## 6.3 画面所有的接口调用逻辑

- 本画面**无**直接接口调用；数据由主画面 **setValue(replys_)** 传入，replys_ 来自主画面初期化的 **getVari**（回答区分マスタ）。

---

## 6.4 画面中每个组件的行为约束

- list1_：仅选择，不可编辑；选项完全由主画面传入。

---

## 6.5 画面与其它画面的调用关系

- **被谁打开**: 主画面在表「回答区分」列编辑时弹出 replyDialog_.show()；打开前 initReplyDialog、setValue(replys_)。
- **打开谁**: 无。

---

## 6.6 画面相关的数据表

- 本画面无直接表；**getVari** 对应的回答区分マスタ（OrderEntryNo_s 侧）为数据来源。

---

# 画面七：试作出荷/工厂番号对话框（FactoryNumberDialog）

**类名**: `FactoryNumberDialog`  
**包**: `SMS01206`  
**继承**: `CDJDialog`  
**尺寸**: 约 308×200  
**标题**: 出荷実績入力（無償出荷）

---

## 7.1 画面上的所有交互行为

| 交互动作 | 触发方式 | 结果概要 |
|----------|----------|----------|
| 打开时 | 主画面 setValue 等 | 主画面传入 entryNo_/entryDetailNo_/qty_ 等；factoryLabel_ 显示确认文 |
| 点击「確認」 | buttonOK_ Action | confirm_=true，dispose |
| 点击「取消」 | buttonNG_ Action | confirm_=false，dispose |

---

## 7.2 画面上每个组件的行为

| 组件 | 类型 | 行为 |
|------|------|------|
| jFPanel1 | JFPanel | 容器 |
| buttonOK_ | JButton | 確認 → confirm_=true，dispose |
| buttonNG_ | JButton | 取消 → confirm_=false，dispose |
| factoryLabel_ | JTextArea(不可编辑) | 显示「出荷にしますか？」等；主画面可 setText 设定内容 |

---

## 7.3 画面所有的接口调用逻辑

- 本画面**无**直接 RMI；主画面在试作出荷流程中调用 **getMaxSalesUpdate**、**setFactoryResults** 等，本对话框仅做确认/取消。

---

## 7.4 画面中每个组件的行为约束

- 仅确认/取消二选一；无输入校验。

---

## 7.5 画面与其它画面的调用关系

- **被谁打开**: 主画面 factoryDialog_.show()（试作出荷相关）。
- **打开谁**: 无。

---

## 7.6 画面相关的数据表

- 本画面无直接表；主画面侧 **getMaxSalesUpdate**、**setFactoryResults** 对应的试作出荷・出荷実績相关表。

---

# 画面八：同一エントリ分割（DistributeOrderDialog）

**类名**: `DistributeOrderDialog`  
**包**: `SMS01206`  
**用途**: 同一エントリー分割；主画面 dialog_.init()/setName()，在会社間・分割流程中 show。

---

## 8.1～8.6 概要

- **交互**: 表显示元エントリ/派生エントリ数量等；确认/取消后回调主画面；主画面侧 getDistributeDeploy、distributeDeploy、updateSmsStatus 等。
- **接口**: 由主画面传入参数并调用服务端 **getDistributeDeploy**、**distributeDeploy**。
- **与它画面关系**: 仅被主画面打开。
- **数据表**: 订单头/明细及派生・status 相关（与 orderUpdate/updateSmsStatus 一致）。

---

# 画面九：継続プラント発注（DeployOrderDialog）

**类名**: `DeployOrderDialog`  
**用途**: 継続プラント发注；主画面 dialog2_.init()/setName()，在継続プラント流程中 show。

---

## 9.1～9.6 概要

- **交互/接口/关系**: 与主画面 getDeployEntry、orderInsert 等连动；仅被主画面打开。
- **数据表**: 订单与継続プラント相关表。

---

# 画面十：会社間派生（DeployDistributeDialog）

**类名**: `DeployDistributeDialog`  
**用途**: 会社間派生；主画面 dialog3_.init()/setName()。

---

## 10.1～10.6 概要

- **交互/接口/关系**: 会社間派生数量等；主画面 distributeDeploy、updateSmsStatus 等；仅被主画面打开。
- **数据表**: 订单与会社間・status 相关表。

---

# 画面十一：税区分（TaxDialog）

**类名**: `TaxDialog`  
**用途**: 税区分选择；主画面 dialog4_.init()。

---

## 11.1～11.6 概要

- **交互**: list1_ 等选择税区分；确认后回写主画面。
- **接口**: 税区分マスタ由主画面或服务端取得。
- **与它画面关系**: 仅被主画面打开。
- **数据表**: 税区分マスタ。

---

# 画面十二：OUT-IN（OutinDialog）

**类名**: `OutinDialog`  
**包**: `SMS01206`  
**用途**: OUT-IN 连携；主画面实现 OutinDialog_i，dialog6_.init()/setName()。

---

## 12.1～12.6 概要

- **交互**: 表与输入项用于 OUT-IN 数据确认/编辑。
- **接口**: 主画面 **getOutInData**、**updateOutinData** 与 getOrderSub/getOrder 等配合。
- **与它画面关系**: 仅被主画面打开；主画面 OUT-IN 时显示 oiPanel_ 等。
- **数据表**: 订单头/明细及 OUT-IN 连携用项目（d_business_line_code 等）。

---

# 画面十三：等待对话框（Dialog1 / waitDialog_）

**类名**: `Dialog1`  
**包**: `SMS01206`  
**标题**: しばらくお待ち下さい。（可 setTitle 如 labelHash_.get("4667")）  
**尺寸**: 约 252×56（initUser 中 252×30）

---

## 13.1 画面上的所有交互行为

- 无用户操作；主画面在处理前 **waitDialog_.show()**，处理结束后 **waitDialog_.dispose()**。

---

## 13.2 画面上每个组件的行为

- 无 Bean；仅标题与边框，无按钮/输入。

---

## 13.3 画面所有的接口调用逻辑

- 无。

---

## 13.4 画面中每个组件的行为约束

- 无。

---

## 13.5 画面与其它画面的调用关系

- **被谁打开**: 主画面在 insert/update/delete、R3 移行、同梱品更新、与信判定等长时间处理前 show，处理后 dispose。
- **打开谁**: 无。

---

## 13.6 画面相关的数据表

- 无。

---

# 附录：确认对话框（JOptionPane / displayConfirmDialog）

- **调用处**: OrderEntryNo 内 displayConfirmDialog(key)、displayConfirmDialog2(key)。
- **用途**: 追加/更新/削除/错误/R3 移行/关闭确认等；key 对应 MSG_INSERT、MSG_UPDATE、MSG_DELETE、MSG_ERR、MSG_ERR1、*1～*5、m1/m2、? 等，从 labelHash_ 取文案；选项为 Yes/No/Cancel 或 Yes(Q)/No/(R)/Cancel。
- **与它画面关系**: 不单独作为“画面”打开，由主画面或 ConsignDialog 等在需要时弹出。
- **数据表**: 无。

---

以上为按画面逐个整理的 Sms01206 详细交互分析报告（仅依据 Sms01206 源码，不引用 SmsWeb）。若需对某一画面补充到字段级或接口参数级，可指定画面编号或类名。
